# Creation Hub 改善計画

## 概要

Creation Hub の初期実装後に発見された不足点・余計な機能・改善が必要な箇所を修正する。
主要プラットフォーム（YouTube、Twitch、Netflix）のベストプラクティスに従い、ユーザーが直感的に理解できるUIを目指す。

---

## 優先度分類

### 🔴 高優先度（Phase A）- 即座に対応すべき
1. Netflix/Liveコンテンツの表示UI定義
2. プライバシー設定の表記変更
3. ライブ配信遅延設定の削除

### 🟡 中優先度（Phase B）- 次回対応推奨
4. Netflix編集画面の追加
5. Analyticsグラフの追加
6. エピソード管理の改善

### 🟢 低優先度（Phase C）- 将来対応可
7. Analytics期間選択機能
8. ライブアーカイブフロー
9. 成人向けコンテンツ警告

---

# Phase A: 高優先度修正

## A-1. Netflix/Liveコンテンツの表示UI定義

### 問題
`ContentsContent.tsx`にNetflix/Liveタブを追加したが、実際にデータが存在したときの表示方法が未定義。
現在の`renderContentList()`は動画・ショート用のUIをそのまま流用しており、Netflix/Liveの特性に対応していない。

### 解決方針
コンテンツタイプごとに専用の表示UIを実装する。

### Netflix表示UI仕様

**映画の場合:**
```
┌────────────────────────────────────────┐
│ [ポスター]  タイトル                    │
│  (2:3)     説明文...                   │
│            映画 | 120分 | 2025年        │
│            再生回数: 15.2万             │
│            [編集] [削除]                │
└────────────────────────────────────────┘
```

**シリーズの場合:**
```
┌────────────────────────────────────────┐
│ [ポスター]  タイトル                    │
│  (2:3)     説明文...                   │
│            シリーズ | 2シーズン | 20話  │
│            総再生回数: 152万            │
│            [編集] [削除]                │
└────────────────────────────────────────┘
```

**実装内容:**
- `ContentPerformance`型に`type`フィールドがあるので判別可能
- 映画: `duration`を「〇〇分」表示
- シリーズ: `seasons.length`と`episodes.length`を表示
- ポスター画像は2:3比率（既存の16:9サムネイルと区別）

### Live表示UI仕様

**配信中:**
```
┌────────────────────────────────────────┐
│ [●LIVE]     タイトル                   │
│ [サムネ]    カテゴリー: ゲーム         │
│ (16:9)     👁 1,234人視聴中            │
│            配信時間: 01:23:45           │
│            [配信画面へ] [終了]         │
└────────────────────────────────────────┘
```

**予定:**
```
┌────────────────────────────────────────┐
│ [予定]      タイトル                   │
│ [サムネ]    カテゴリー: 音楽           │
│ (16:9)     📅 2025/10/25 20:00開始予定 │
│            [編集] [削除]                │
└────────────────────────────────────────┘
```

**終了（アーカイブ）:**
```
┌────────────────────────────────────────┐
│ [終了]      タイトル                   │
│ [サムネ]    カテゴリー: トーク         │
│ (16:9)     再生回数: 5,678             │
│            最大同時視聴者: 2,345人     │
│            [アーカイブ編集] [削除]     │
└────────────────────────────────────────┘
```

**実装内容:**
- `LiveStream`型の`status`フィールドで判別
- 配信中: 赤い●LIVE バッジ、現在視聴者数、配信画面へのリンク
- 予定: 📅アイコン、開始予定時刻
- 終了: 再生回数、最大同時視聴者数、アーカイブ編集ボタン

### 実装ファイル
- `components/creation/ContentsContent.tsx`の`renderContentList()`を拡張
- `renderNetflixContent()`, `renderLiveContent()`として分離

---

## A-2. プライバシー設定の表記変更

### 問題
ライブ配信の「非公開」という表記が、「自分しか見られない」ことを直感的に伝えていない。
一般的に「非公開」は「誰にも見せない」を連想させるが、実際は「テスト配信」の用途。

### 解決方針
業界標準の表記に従う。

### 変更内容

**変更前:**
```
○ 公開 - 誰でも視聴可能
○ 限定公開 - URLを知っている人のみ
○ 非公開 - 自分のみ視聴可能
```

**変更後:**
```
○ 公開 - 誰でも視聴可能
○ 限定公開 - URLを知っている人のみ
○ 下書き（テスト配信） - 自分のみ視聴可能
```

**根拠:**
- YouTube: 「公開 / 限定公開 / 非公開」だが、配信では「下書き」表記を使用
- Twitch: 「Public / Subscriber-only / Private」
- 一般的に「下書き」は「未完成・テスト」を連想しやすい

### 実装ファイル
- `app/go-live.tsx`のプライバシー選択肢
- `types/index.ts`の`LiveStream.privacy`型定義を`'public' | 'unlisted' | 'draft'`に変更

---

## A-3. ライブ配信遅延設定の削除

### 問題
「通常 / 低遅延 / 超低遅延」の選択肢は、一般ユーザーには理解が難しく、選択ミスによる配信トラブルの原因になる。
技術的には意味があるが、YouTubeでも「詳細設定」に隠されている機能。

### 解決方針
遅延設定を削除し、デフォルト「通常」固定とする。

### 削除内容
- 遅延選択UI（3つのボタン）
- `delay`のstate管理
- `types/index.ts`の`LiveStream.delay`フィールド

### 代替案
将来的に上級者向け機能として「詳細設定」に移動することは可能だが、現段階では不要。

### 実装ファイル
- `app/go-live.tsx`の遅延設定セクション削除
- `types/index.ts`の`LiveStreamCreate`から`delay`フィールド削除
- `utils/mockApi.ts`の`createLiveStream()`から`delay`削除

---

# Phase B: 中優先度修正

## B-1. Netflix編集画面の追加

### 問題
動画・ショートには編集画面（`app/creation/video/[id]/edit.tsx`）があるが、Netflixコンテンツには存在しない。
ContentsタブのNetflixタブで「編集」ボタンを押してもエラーになる。

### 解決方針
Netflix専用の編集画面を作成する。映画とシリーズで異なるUIを提供。

### 画面構成

**ルート:**
- `app/creation/netflix/[id]/edit.tsx`

**編集可能項目:**
- タイトル、説明、ジャンル、制作国、公開年
- ポスター/バックドロップ画像の変更
- サブスクリプションティア変更
- 成人向けフラグ変更

**シリーズ特有の機能:**
- シーズン追加/削除
- エピソード追加/編集/削除
- エピソードの並び替え

**UI設計:**
```
┌──────────────────────────────────┐
│ [←] Netflix型コンテンツ編集       │
├──────────────────────────────────┤
│ タイプ: [映画] / [シリーズ]       │
│                                  │
│ 基本情報                          │
│ ├ タイトル: [___________]        │
│ ├ 説明: [___________]            │
│ └ ジャンル: [選択済み...]         │
│                                  │
│ 画像                              │
│ ├ ポスター: [変更]               │
│ └ バックドロップ: [変更]         │
│                                  │
│ [シリーズの場合]                 │
│ シーズン管理                      │
│ ├ シーズン1 (10話)               │
│ │  └ [エピソード編集]            │
│ └ [シーズン追加]                 │
│                                  │
│ [保存] [キャンセル]               │
└──────────────────────────────────┘
```

### 実装ステップ
1. ディレクトリ作成: `app/creation/netflix/[id]/`
2. `edit.tsx`作成
3. 既存の`upload-netflix-movie.tsx`のUIを再利用
4. `updateNetflixContent()`でAPIに保存
5. `ContentsContent.tsx`の編集ボタンからルーティング

---

## B-2. Analyticsグラフの追加

### 問題
`analytics.json`に30日分の`views_timeline`データがあるが、折れ線グラフで表示していない。
数字の羅列だけでは推移が直感的に理解できない。

### 解決方針
Expo/React Native対応のグラフライブラリで折れ線グラフを実装。

### 推奨ライブラリ

**Victory Native:**
- 公式推奨: https://formidable.com/open-source/victory/
- React Native完全対応
- カスタマイズ性が高い

**インストール:**
```bash
npm install victory-native react-native-svg
```

### グラフ仕様

**表示データ:**
- X軸: 日付（過去30日）
- Y軸: 再生回数

**デザイン:**
```
再生回数推移（過去30日）
┌──────────────────────────────────┐
│ 60k ─                     ●      │
│     │                   ●   ●    │
│ 50k ─              ●  ●       ●  │
│     │          ●                 │
│ 40k ─    ●  ●                    │
│     └─────────────────────────── │
│      9/23  10/1  10/10  10/22    │
└──────────────────────────────────┘
```

**実装場所:**
- `AnalyticsContent.tsx`の統計カードの下
- モバイル: 横スクロール可能
- デスクトップ: 全幅表示

### 実装コード例
```tsx
import { VictoryLine, VictoryChart, VictoryAxis } from 'victory-native';

<VictoryChart>
  <VictoryAxis
    tickFormat={(t) => new Date(t).toLocaleDateString('ja-JP', { month: 'numeric', day: 'numeric' })}
  />
  <VictoryAxis dependentAxis />
  <VictoryLine
    data={analytics.views_timeline.map(d => ({ x: d.date, y: d.views }))}
    style={{ data: { stroke: Colors.primary } }}
  />
</VictoryChart>
```

---

## B-3. エピソード管理の改善

### 問題
シリーズアップロード時、エピソード追加が`Alert.alert()`だけで完結しており、実際には：
- タイトル・説明を入力できない
- 動画ファイルを選択できない
- エピソードごとのサムネイルを設定できない

### 解決方針
エピソード追加時に専用のモーダル/画面を表示し、詳細情報を入力可能にする。

### UI設計

**方法1: モーダル方式（推奨）**

エピソード追加ボタン → モーダル表示 → 入力 → 保存

```
┌──────────────────────────────────┐
│ エピソード追加                    │
├──────────────────────────────────┤
│ エピソード番号: [自動: 1]        │
│ タイトル: [___________]          │
│ 説明: [___________]              │
│ 再生時間（分）: [45]             │
│                                  │
│ サムネイル: [選択]               │
│ 動画ファイル: [選択]             │
│                                  │
│ [キャンセル] [追加]              │
└──────────────────────────────────┘
```

**方法2: 別画面方式**

シリーズ作成 → エピソード追加ボタン → `/upload-episode` → 入力 → 戻る

### 推奨: モーダル方式
- シリーズ作成フロー中断が少ない
- 複数エピソードを連続追加しやすい
- 一般的なパターン（YouTube Studioも同様）

### 実装内容
1. `EpisodeFormModal.tsx`コンポーネント作成
2. タイトル、説明、動画ファイル、サムネイル、再生時間の入力欄
3. モーダル表示/非表示の制御
4. `upload-netflix-series.tsx`に統合

### データ構造
```typescript
interface EpisodeUpload {
  episode_number: number;
  title: string;
  description: string;
  duration: number;
  video_file: File;
  thumbnail?: File;
}
```

---

# Phase C: 低優先度修正

## C-1. Analytics期間選択機能

### 概要
「過去7日 / 30日 / 90日 / カスタム期間」を選択可能にする。

### 実装内容
- 期間選択ドロップダウン/タブ
- `getAnalytics(period: string)`でAPIに期間指定
- グラフとカードの数値を再取得

### 優先度が低い理由
モックデータ段階では期間データが1種類しかないため、実装しても効果が見えにくい。

---

## C-2. ライブアーカイブフロー

### 概要
配信終了時に「アーカイブを動画として公開しますか？」の選択肢を表示。

### 実装内容
- 配信終了時のダイアログ
- アーカイブ保存 → Contentsタブの「動画」に追加
- タイトル・説明の編集機能

### 優先度が低い理由
実際のライブ配信システム実装時に詳細仕様を決定すべき。

---

## C-3. 成人向けコンテンツ警告

### 概要
アップロード時に「このコンテンツはWeb版でのみ視聴可能です」と警告表示。

### 実装内容
- `is_adult`チェック時に警告文表示
- プラットフォーム判定（`Platform.OS === 'web'`）

### 優先度が低い理由
プラットフォーム統合時に仕様確定すべき。

---

# 実装順序

## Phase A（今すぐ実装）
1. ライブ配信遅延設定の削除 ← 最も簡単
2. プライバシー設定の表記変更 ← 簡単
3. Netflix/Live表示UIの定義 ← 重要

## Phase B（次回対応）
4. Netflix編集画面の追加
5. Analyticsグラフの追加
6. エピソード管理の改善

## Phase C（将来対応）
7. Analytics期間選択
8. ライブアーカイブフロー
9. 成人向けコンテンツ警告

---

# 補足: 一般的なベストプラクティス

## YouTube Studio の設計パターン
- シンプルな3段階プライバシー（公開/限定公開/非公開）
- 遅延設定は「詳細設定」に隠蔽
- エピソード管理はモーダル方式
- グラフを多用した視覚的なAnalytics

## Netflix Studio（架空）の設計パターン
- 映画とシリーズで明確に分離されたUI
- エピソードは階層構造で管理
- ポスター（2:3）とバックドロップ（16:9）の2種類の画像

## Twitch Creator Dashboard
- ライブ配信はシンプルな設定のみ
- リアルタイム統計の強調
- アーカイブは自動保存、後から編集可能

---

# まとめ

Phase Aの3項目を優先実装することで、Creation Hubの基本機能が完成する。
Phase BとCは機能拡張であり、ユーザーフィードバックを受けてから実装判断すべき。

**Phase A完了後の状態:**
- ✅ Netflix/Liveコンテンツが正しく表示される
- ✅ ライブ配信設定が直感的で分かりやすい
- ✅ 不要な設定項目が削除され、シンプルになる

**Phase B完了後の状態:**
- ✅ 全てのコンテンツタイプで編集可能
- ✅ Analyticsが視覚的で分かりやすい
- ✅ エピソード管理が実用的

**Phase C完了後の状態:**
- ✅ 期間を自由に選択してAnalyticsを分析可能
- ✅ ライブアーカイブの管理が完全
- ✅ プラットフォーム間の整合性が完璧
